(this["webpackJsonpcovid-map-app"]=this["webpackJsonpcovid-map-app"]||[]).push([[0],{47:function(e,t,o){e.exports=o(75)},72:function(e,t,o){},74:function(e,t,o){},75:function(e,t,o){"use strict";o.r(t);var n=o(0),a=o.n(n),r=o(22),c=o.n(r),i=o(26),s=o(15),l=o(18),u=o(44),d=o(7),p=o(5),m=o(45),C=o.n(m),v=function(){return a.a.createElement("nav",null,"Nav bar")},g=o(6),y=o(21),h=o(31),f=Object(s.b)((function(e){return{total:e.total,points:e.points,clusterPoints:e.clusterPoints}}),{})((function(e){var t=e.width,o=e.height,r=e.points,c=e.total,i=e.clusterPoints,s=Object(n.useState)("totalDeaths"),l=Object(p.a)(s,2),u=l[0],d=(l[1],Object(n.useState)({latitude:0,longitude:0,width:t,height:o,zoom:0})),m=Object(p.a)(d,2),C=m[0],v=m[1],f=Object(n.useRef)(),b=f.current?f.current.getMap().getBounds().toArray().flat():null,E=Object(h.a)({points:i,zoom:C.zoom,bounds:b,options:{radius:75,maxZoom:20}}),O=E.clusters,D=E.supercluster,j=Object(h.a)({points:r.reduce((function(e,t){return"None"===t.point.geometry.type||t.provincePoints.length>0?e:[].concat(Object(g.a)(e),[t.point])}),[]),zoom:C.zoom,bounds:b,options:{radius:75,maxZoom:20}}),P=j.clusters,T=j.supercluster,k=function e(t,o){return t.properties.cluster?o.getChildren(t.id).reduce((function(t,n){return t+e(n,o)}),0):t.properties.cases[u]},z=function(){return c[u]};return a.a.createElement(a.a.Fragment,null,a.a.createElement(y.b,Object.assign({},C,{maxZoom:20,mapboxApiAccessToken:"pk.eyJ1IjoibGltZXBlYWNoIiwiYSI6ImNrY2RyNXVicDAxN2UzM3A4aGVkbmNlazMifQ.Yz5AUxZ_z7jd5QrcJS1mpQ",onViewportChange:function(e){return v(e)},mapStyle:"mapbox://styles/mapbox/dark-v10",ref:f}),P.map((function(e){return k(e,T)?a.a.createElement(y.a,{key:"countryCluster-".concat(e.id?e.id:e.properties.country),latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0]},a.a.createElement("div",{onClick:function(){return console.log(e,k(e,T))},className:k(e,T)?"country-marker":"zero-marker",style:{width:"".concat(5+C.zoom/5+k(e,T)/z()*(200+300*C.zoom)+z()/(1e6*k(e,T))/5,"px"),height:"".concat(5+C.zoom/5+k(e,T)/z()*(200+300*C.zoom)+z()/(1e6*k(e,T))/5,"px")}})):null})),O.map((function(e){var t=Object(p.a)(e.geometry.coordinates,2),o=t[0],n=t[1],r=e.properties,c=r.cluster,i=(r.point_count,k(e,D));return c?i?a.a.createElement(y.a,{key:"generalCluster-".concat(e.id),latitude:n,longitude:o},a.a.createElement("div",{className:k(e,D)?"cluster-marker":"zero-marker",style:{width:"".concat(5+C.zoom/5+i/z()*(200+300*C.zoom)+z()/(1e6*i)/5,"px"),height:"".concat(5+C.zoom/5+i/z()*(200+300*C.zoom)+z()/(1e6*i)/5,"px")},onClick:function(){return console.log(D.getChildren(e.id))}})):null:i?a.a.createElement(y.a,{key:"".concat(e.properties.countryCode).concat(e.properties.province?"-"+e.properties.province:"").concat(e.properties.cityCode?"-"+e.properties.cityCode:""),latitude:n,longitude:o},a.a.createElement("div",{onClick:function(){return console.log(e)},className:k(e,D)?"cluster-marker":"zero-marker",style:{width:"".concat(5+C.zoom/5+i/z()*(200+300*C.zoom)+z()/(1e6*i)/5,"px"),height:"".concat(5+C.zoom/5+i/z()*(200+300*C.zoom)+z()/(1e6*i)/5,"px")}})):null}))),a.a.createElement("button",{onClick:function(){return console.log(r)}},"Show Points"))})),b={fetchVirusData:function(){return function(e){C.a.get("https://api.covid19api.com/all").then((function(t){return e({type:"FETCH_VIRUS_DATA",virusData:t})})).catch((function(t){return console.error(t),e({type:"FETCH_VIRUS_DATA",virusData:{status:404}})}))}},fetchDates:function(){return{type:"FETCH_DATES"}},fetchCountries:function(e){return{type:"FETCH_COUNTRIES",date:e}},fetchTotalCases:function(e){return{type:"FETCH_TOTAL_CASES",date:e}},fetchPoints:function(e){return{type:"FETCH_POINTS",date:e}},fetchClusterPoints:function(e){return{type:"FETCH_CLUSTER_POINTS",date:e}}},E=Object(s.b)((function(e){return{virusData:e.virusData,points:e.points,clusterPoints:e.clusterPoints}}),b)((function(e){var t=e.virusData,o=e.points,r=e.clusterPoints,c=e.fetchVirusData,i=e.fetchDates,s=e.fetchCountries,l=e.fetchTotalCases,u=e.fetchPoints,d=e.fetchClusterPoints,m=Object(n.useState)(!1),C=Object(p.a)(m,2),g=C[0],y=C[1];return Object(n.useEffect)((function(){g||(console.log("Getting Virus Data"),c(),y(!0)),g&&t&&(console.log("Getting Dates"),i(),console.log("Getting Countries"),s(),console.log("Getting Total Cases"),l(),console.log("Getting Points"),u(),d())}),[t]),a.a.createElement(a.a.Fragment,null,a.a.createElement(v,null),a.a.createElement("div",{className:"container"},console.log(o),o.length>0&&r.length>0?a.a.createElement(f,{width:"100%",height:"50vh"}):a.a.createElement("h1",null,"Loading . . .")))})),O=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(v,null),a.a.createElement("div",{className:"container"},a.a.createElement("h1",null,"404 Page Not Found")))},D=(o(72),function(){return a.a.createElement("div",{className:"App"},a.a.createElement(d.d,null,a.a.createElement(d.b,{exact:!0,path:"/"},a.a.createElement(d.a,{to:"/covid-map-app/"})),a.a.createElement(d.b,{exact:!0,path:"/covid-map-app/"},a.a.createElement(E,null)),a.a.createElement(O,null)))}),j=o(12),P={virusData:{},dates:new Map,countries:new Map,points:[],total:0,dailyTotal:[]},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_VIRUS_DATA":return console.log("Virus Data",t.virusData),Object(j.a)({},e,{virusData:t.virusData});case"FETCH_DATES":var o=new Map;return e.virusData.data.forEach((function(e){return o.has(e.Date)?o.set(e.Date,[].concat(Object(g.a)(o.get(e.Date)),[e])):o.set(e.Date,[e])})),console.log("Dates",o),Object(j.a)({},e,{dates:o});case"FETCH_COUNTRIES":var n=new Map;return e.dates.get(t.date?t.date:Object(g.a)(e.dates.keys())[e.dates.size-2]).forEach((function(e){var t=new Map,o=new Map,a={},r={};n.has(e.Country)?(t=n.get(e.Country).provinces,e.Province.length>0&&(n.get(e.Country).provinces.has(e.Province)&&(o=n.get(e.Country).provinces.get(e.Province).cities,e.City&&!o.has(e.City)&&o.set(e.City,e)),t.has(e.Province)?t.set(e.Province,{places:[].concat(Object(g.a)(t.get(e.Province).places),[e]),cities:o}):t.set(e.Province,{places:[e],cities:o})),e.Province||e.City&&"Unassigned"!==e.City?(a=n.get(e.Country).totalCases,r=n.get(e.Country).coordinates):(a={active:e.Active,totalConfirmed:e.Confirmed,totalDeaths:e.Deaths,totalRecovered:e.Recovered},r={Lon:e.Lon,Lat:e.Lat}),n.set(e.Country,{places:[].concat(Object(g.a)(n.get(e.Country).places),[e]),totalCases:a,coordinates:r,countryCode:e.CountryCode,provinces:t})):(e.Province.length>0&&(e.City&&o.set(e.City,e),t.set(e.Province,{places:[e],cities:o})),e.Province||e.City&&"Unassigned"!==e.City||(a={active:e.Active,totalConfirmed:e.Confirmed,totalDeaths:e.Deaths,totalRecovered:e.Recovered},r={Lon:e.Lon,Lat:e.Lat}),n.set(e.Country,{places:[e],totalCases:a,coordinates:r,countryCode:e.CountryCode,provinces:t}))})),console.log("Countries",n),Object(j.a)({},e,{countries:n});case"FETCH_TOTAL_CASES":var a=Object(g.a)(e.countries.keys()).reduce((function(t,o){return Object.keys(e.countries.get(o).totalCases).length>0?Object(j.a)({},t,{active:t.active+e.countries.get(o).totalCases.active,totalConfirmed:t.totalConfirmed+e.countries.get(o).totalCases.totalConfirmed,totalDeaths:t.totalDeaths+e.countries.get(o).totalCases.totalDeaths,totalRecovered:t.totalRecovered+e.countries.get(o).totalCases.totalRecovered}):Object(j.a)({},t,{},e.countries.get(o).places.reduce((function(e,t,o){return{active:e.active+t.Active,totalConfirmed:e.totalConfirmed+t.Confirmed,totalDeaths:e.totalDeaths+t.Deaths,totalRecovered:e.totalRecovered+t.Recovered}}),t))}),{day:t.date?t.date:Object(g.a)(e.dates.keys())[e.dates.size-2],active:0,totalConfirmed:0,totalDeaths:0,totalRecovered:0});return console.log("Total",a),Object(j.a)({},e,{total:a});case"FETCH_POINTS":new Map,new Map;var r=Object(g.a)(e.countries.keys()).map((function(t){return{point:{type:"Feature",properties:{cluster:!1,category:"country",cases:Object.keys(e.countries.get(t).totalCases).length>0?e.countries.get(t).totalCases:e.countries.get(t).places.reduce((function(e,t){return t.Province.length>0||t.City.length>0?{active:e.active+t.Active,totalConfirmed:e.totalConfirmed+t.Confirmed,totalDeaths:e.totalDeaths+t.Deaths,totalRecovered:e.totalRecovered+t.Recovered}:e}),{active:0,totalConfirmed:0,totalDeaths:0,totalRecovered:0}),country:t,countryCode:e.countries.get(t).countryCode},geometry:{type:Object.keys(e.countries.get(t).coordinates).length>0?"Point":"None",coordinates:Object.keys(e.countries.get(t).coordinates).length>0?[parseFloat(e.countries.get(t).coordinates.Lon),parseFloat(e.countries.get(t).coordinates.Lat)]:[]}},provincePoints:e.countries.get(t).provinces?Object(g.a)(e.countries.get(t).provinces.keys()).map((function(o){return e.countries.get(t).provinces.get(o).places.map((function(o){return{type:"Feature",properties:{cluster:!1,category:o.City?"city":"province",cases:{active:o.Active,totalConfirmed:o.Confirmed,totalDeaths:o.Deaths,totalRecovered:o.Recovered},city:o.City,cityCode:o.CityCode,country:t,countryCode:e.countries.get(t).countryCode,province:o.Province},geometry:{type:"Point",coordinates:[parseFloat(o.Lon),parseFloat(o.Lat)]}}}))})):[]}}));return console.log("Points",r),Object(j.a)({},e,{points:r});case"FETCH_CLUSTER_POINTS":var c=e.points.reduce((function(e,t){return t.provincePoints.length>0?[].concat(Object(g.a)(e),Object(g.a)(t.provincePoints.reduce((function(e,t){return[].concat(Object(g.a)(e),Object(g.a)(t))}),[]))):e}),[]);console.log("Cluster Points",c);var i=Object(g.a)(e.dates.get(t.date?t.date:Object(g.a)(e.dates.keys())[e.dates.size-1]).filter((function(e){return e.Lat&&e.Lon})).map((function(e){return{type:"Feature",properties:{cluster:!1,category:e.City?"city":e.Province?"province":"country",cases:{active:e.Active,confirmed:e.Confirmed,deaths:e.Deaths,recovered:e.Recovered},city:e.City,cityCode:e.CityCode,country:e.Country,countryCode:e.CountryCode,province:e.Province},geometry:{type:"Point",coordinates:[parseFloat(e.Lon),parseFloat(e.Lat)]}}})));return console.log("Points example",i),Object(j.a)({},e,{clusterPoints:c});default:return Object(j.a)({},e)}},k=(o(74),Object(l.c)(T,Object(l.a)(u.a)));c.a.render(a.a.createElement(s.a,{store:k},a.a.createElement(i.a,null,a.a.createElement(a.a.StrictMode,null,a.a.createElement(D,null)))),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.d3932211.chunk.js.map